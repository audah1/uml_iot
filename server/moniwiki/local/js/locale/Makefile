# $Id$
#
# local/js/locale/Makefile
#
# This is a replacement for locale/translate.sh to avoid remaking
# files that don't need to be remade.
#

POT_FILE = po/moniwiki.pot

.PHONY: all po clean dep ${POT_FILE}

all	: po js
po 	: # dependencies are auto-generated by 'make dep' , see below
js	: # dependencies are auto-generated by 'make dep' , see below

${POT_FILE} : # dependencies are auto-generated by 'make dep' , see below
	test -f $@ || touch $@
	cp -f $@ $@~
	xgettext --from-code=UTF-8 -L Python -kt_ -k_t -kN_ -o $@.extracted $^
	msgmerge -o $@ $@~ $@.extracted && rm -f $@.extracted

po/%.po : ${POT_FILE}
	test -f $@ || touch $@
	cp -f $@ $@~
	msgmerge -o $@.new $@~ $^ && mv -f $@.new $@

euckr:
	iconv -f UTF-8 -t EUC-KR po/ko.po |sed 's/UTF-8/EUC-KR/' >po/ko_KR.po
	mkdir -p ko_KR
	rm po/ko_KR.po

# Generate .php from .mo rather than .po to maximize
# the probability of agreement between .mo and .php files.
%/moniwiki.js : po/%.po
	mkdir -p $*
	cat $< | awk -f make-js-trans.awk > $@

clean :
	rm -f ${MO_FILES} ${PHP_FILES}

dep :
	$(SHELL) update-makefile.sh


# DO NOT DELETE THIS LINE
#
# The remainder of this file is auto-generated
#
# (Run 'make dep' to regenerate this section.)
#
po: po/fr.po
js: fr/moniwiki.js
po: po/ko.po
js: ko/moniwiki.js
#
${POT_FILE}: ../../SWFUpload/handlers.js
${POT_FILE}: ../../SWFUpload/mmSWFUpload.js
${POT_FILE}: ../../SWFUpload/moni.js
${POT_FILE}: ../../SWFUpload/preview.js
${POT_FILE}: ../../SWFUpload/swfupload.js
${POT_FILE}: ../../SWFUpload/swfupload.queue.js
${POT_FILE}: ../../SWFUpload/swfupload.swfobject.js
${POT_FILE}: ../../Wikiwyg/lib/Wikiwyg/Debug.js
${POT_FILE}: ../../Wikiwyg/lib/Wikiwyg/HTML.js
${POT_FILE}: ../../Wikiwyg/lib/Wikiwyg.js
${POT_FILE}: ../../Wikiwyg/lib/Wikiwyg/Preview.js
${POT_FILE}: ../../Wikiwyg/lib/Wikiwyg/Toolbar.js
${POT_FILE}: ../../Wikiwyg/lib/Wikiwyg/Util.js
${POT_FILE}: ../../Wikiwyg/lib/Wikiwyg/Wikitext.js
${POT_FILE}: ../../Wikiwyg/lib/Wikiwyg/Wysiwyg.js
${POT_FILE}: ../../ac.js
${POT_FILE}: ../../ajax.js
${POT_FILE}: ../../ASCIIMathML.js
${POT_FILE}: ../../autosave.js
${POT_FILE}: ../../chat.js
${POT_FILE}: ../../checkbox.js
${POT_FILE}: ../../fixmathml.js
${POT_FILE}: ../../folding.js
${POT_FILE}: ../../footnotes.js
${POT_FILE}: ../../googlehi.js
${POT_FILE}: ../../latex.js
${POT_FILE}: ../../LaTeXMathML.js
${POT_FILE}: ../../lineheight.js
${POT_FILE}: ../../md5.js
${POT_FILE}: ../../mobile.js
${POT_FILE}: ../../moniwyg.js
${POT_FILE}: ../../numbering.js
${POT_FILE}: ../../pasta.js
${POT_FILE}: ../../pull.js
${POT_FILE}: ../../rc.js
${POT_FILE}: ../../se.js
${POT_FILE}: ../../slideshow.js
${POT_FILE}: ../../subindex.js
${POT_FILE}: ../../textarea.js
${POT_FILE}: ../../toctoggle.js
${POT_FILE}: ../../tz.js
${POT_FILE}: ../../uploader.js
${POT_FILE}: ../../wikibits.js
${POT_FILE}: dummy.js
